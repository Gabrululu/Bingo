<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo Marketero</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iYmciIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojNjY3ZWVhO3N0b3Atb3BhY2l0eToxIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM3NjRiYTI7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJjYXJkIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj4KICAgICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3R5bGU9InN0b3AtY29sb3I6I2ZmZmZmZjtzdG9wLW9wYWNpdHk6MSIgLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIxMDAlIiBzdHlsZT0ic3RvcC1jb2xvcjojZjhmOWZhO3N0b3Atb3BhY2l0eToxIiAvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICA8L2RlZnM+CiAgCiAgPCEtLSBCYWNrZ3JvdW5kIC0tPgogIDxyZWN0IHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgcng9IjYiIGZpbGw9InVybCgjYmcpIi8+CiAgCiAgPCEtLSBCaW5nbyBDYXJkIC0tPgogIDxyZWN0IHg9IjYiIHk9IjgiIHdpZHRoPSIyMCIgaGVpZ2h0PSIxNiIgcng9IjIiIGZpbGw9InVybCgjY2FyZCkiIHN0cm9rZT0iI2Y4ZjlmYSIgc3Ryb2tlLXdpZHRoPSIwLjUiLz4KICA8L3N2Zz4K">
    
    <!-- Meta Tags Sociales -->
    <meta name="description" content="Bingo Web3 interactivo para comunidades de marketing y blockchain. Juega con t√©rminos de DeFi, NFT, DAO y m√°s.">
    <meta name="keywords" content="bingo, web3, nft, defi, dao, blockchain, marketing, comunidad, juego">
    <meta name="author" content="MKT Community">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tu-dominio.com/">
    <meta property="og:title" content="Bingo Web3 - MKT Community">
    <meta property="og:description" content="Bingo Web3 interactivo para comunidades de marketing y blockchain. Juega con t√©rminos de DeFi, NFT, DAO y m√°s.">
    <meta property="og:image" content="https://tu-dominio.com/favicon.svg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://tu-dominio.com/">
    <meta property="twitter:title" content="Bingo Web3 - MKT Community">
    <meta property="twitter:description" content="Bingo Web3 interactivo para comunidades de marketing y blockchain. Juega con t√©rminos de DeFi, NFT, DAO y m√°s.">
    <meta property="twitter:image" content="https://tu-dominio.com/favicon.svg">
    
    <link rel="stylesheet" href="assets/css/styles.css">
    
    <!-- Firebase SDK v9+ (Modular) -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signInAnonymously, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js';
        import { getFirestore, collection, addDoc, doc, onSnapshot, updateDoc, setDoc, deleteDoc, serverTimestamp, getDocs, query, where, orderBy } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js';
        
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCgWVgfDgYOLCXvMoI6B8cKtc1lt0E2jOc",
            authDomain: "bingo-d2f28.firebaseapp.com",
            projectId: "bingo-d2f28",
            storageBucket: "bingo-d2f28.firebasestorage.app",
            messagingSenderId: "786733165579",
            appId: "1:786733165579:web:a5339c73eaf1d31c3eeb0e",
            measurementId: "G-17C462BPND"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // Make Firebase available globally
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseCreateUserWithEmailAndPassword = createUserWithEmailAndPassword;
        window.firebaseSignInWithEmailAndPassword = signInWithEmailAndPassword;
        window.firebaseSignOut = signOut;
        window.firebaseSignInAnonymously = signInAnonymously;
        window.firebaseOnAuthStateChanged = onAuthStateChanged;
        window.firebaseCollection = collection;
        window.firebaseAddDoc = addDoc;
        window.firebaseDoc = doc;
        window.firebaseOnSnapshot = onSnapshot;
        window.firebaseUpdateDoc = updateDoc;
        window.firebaseSetDoc = setDoc;
        window.firebaseDeleteDoc = deleteDoc;
        window.firebaseServerTimestamp = serverTimestamp;
        window.firebaseGetDocs = getDocs;
        window.firebaseQuery = query;
        window.firebaseWhere = where;
        window.firebaseOrderBy = orderBy;
        
        console.log('Firebase v9+ initialized successfully');
    </script>
</head>
<body>
    <div class="container">
        <!-- Landing Page -->
        <div id="landing-page" class="landing-page">
            <div class="header">
                <div class="community-name">MKT COMMUNITY</div>
                <h1>BINGO WEB3</h1>
                <p>Marketing & Blockchain Edition</p>
            </div>
            
            <div id="moderator-cta" class="moderator-cta">
                <button class="control-btn" onclick="openModeratorLogin()">Acceder como Moderador</button>
            </div>
        </div>

        <!-- Moderator Login -->
        <div id="moderator-login" class="moderator-section hidden">
            <div class="login-container">
                <h2>üîê Acceso de Moderador</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="email">Email:</label>
                        <input type="email" id="email" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Contrase√±a:</label>
                        <input type="password" id="password" required>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Iniciar Sesi√≥n</button>
                        <button type="button" id="showRegister" class="btn btn-secondary">Registrarse</button>
                    </div>
                </form>
                
                <form id="registerForm" class="hidden">
                    <div class="form-group">
                        <label for="regEmail">Email:</label>
                        <input type="email" id="regEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="regPassword">Contrase√±a:</label>
                        <input type="password" id="regPassword" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label for="regConfirmPassword">Confirmar Contrase√±a:</label>
                        <input type="password" id="regConfirmPassword" required>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Registrarse</button>
                        <button type="button" id="showLogin" class="btn btn-secondary">Ya tengo cuenta</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Moderator Dashboard -->
        <div id="moderator-dashboard" class="moderator-section hidden">
            <div class="dashboard-container">
                <div class="dashboard-header">
                    <h2>üéÆ Panel de Moderador</h2>
                    <div class="user-info">
                        <span id="moderatorName"></span>
                        <button id="logoutBtn" class="btn btn-small">Cerrar Sesi√≥n</button>
                    </div>
                </div>

                <!-- My Rooms Section -->
                <div id="my-rooms-section" class="rooms-section">
                    <h3>üè† Mis Salas</h3>
                    <div class="rooms-actions">
                        <button id="createRoomBtn" class="btn btn-primary">
                            üéØ Crear Nueva Sala
                        </button>
                        <button id="refreshRoomsBtn" class="btn btn-secondary">
                            üîÑ Actualizar Lista
                        </button>
                    </div>
                    <div id="roomsList" class="rooms-list">
                        <p class="no-rooms">No tienes salas creadas</p>
                    </div>
                </div>

                <!-- Room Management -->
                <div id="room-management" class="room-section hidden">
                    <div class="room-info">
                        <h3>Sala: <span id="currentRoomCode"></span></h3>
                        <div class="room-status">
                            <span id="roomStatus" class="status-badge">Lobby</span>
                        </div>
                        <button id="backToRoomsBtn" class="btn btn-small">‚Üê Volver a Mis Salas</button>
                    </div>

                    <!-- Share Instructions -->
                    <div class="share-section">
                        <h4>üì§ Compartir Sala</h4>
                        <div class="share-link-container">
                            <input type="text" id="shareLink" readonly>
                            <button id="copyLinkBtn" class="btn btn-secondary">Copiar</button>
                        </div>
                        <p class="share-instructions">
                            Comparte este enlace con los participantes. Ellos solo necesitar√°n ingresar su nombre.
                        </p>
                    </div>

                    <!-- Participants List -->
                    <div class="participants-section">
                        <h4>üë• Participantes (<span id="participantCount">0</span>)</h4>
                        <div id="participantsList" class="participants-list">
                            <p class="no-participants">No hay participantes registrados</p>
                        </div>
                    </div>

                    <!-- Game Controls -->
                    <div class="game-controls">
                        <h4>üéÆ Controles del Juego</h4>
                        <div class="control-buttons">
                            <button id="assignCardsBtn" class="btn btn-secondary">Asignar Cartillas</button>
                            <button id="startGameBtn" class="btn btn-primary">Iniciar Juego</button>
                            <button id="nextTermBtn" class="btn btn-secondary">Siguiente T√©rmino</button>
                            <button id="resetGameBtn" class="btn btn-danger">Reiniciar Todo</button>
                            <button id="deleteRoomBtn" class="btn btn-danger">Eliminar Sala</button>
                        </div>
                    </div>

                    <!-- Current Term Display -->
                    <div class="current-term-section">
                        <h4>üéØ T√©rmino Actual</h4>
                        <div id="currentTerm" class="current-term">Registra participantes y asigna cartillas para comenzar</div>
                    </div>

                    <!-- Called Terms -->
                    <div class="called-terms-section">
                        <h4>üìã T√©rminos Cantados</h4>
                        <div class="game-stats">
                            <span>Llamados: <strong id="termsCalledCount">0</strong></span>
                            <span>Restantes: <strong id="termsRemainingCount">0</strong></span>
                        </div>
                        <div id="calledTermsList" class="called-terms-list"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Participant Mode -->
        <div id="participant-mode" class="content hidden">
            <div id="registration-section">
                <div class="registration-form">
                    <h2>¬°√önete al Bingo Web3!</h2>
                    <p style="color: #7f8c8d; margin-bottom: 20px;">Ingresa tu nombre para participar</p>
                    
                    <div class="form-group">
                        <label for="participantName">Tu nombre:</label>
                        <input type="text" id="participantName" placeholder="Ejemplo: Juan P√©rez" maxlength="20">
                    </div>
                    
                    <button class="register-btn" onclick="registerParticipant()">üöÄ Registrarse</button>
                </div>
            </div>

            <div id="waiting-section" class="hidden">
                <div class="participant-status waiting">
                    <h3>¬°Registrado exitosamente!</h3>
                    <p>Esperando que el moderador asigne las cartillas...</p>
                    <div style="margin-top: 10px;">
                        <strong>Tu nombre:</strong> <span id="registeredName"></span>
                    </div>
                </div>
            </div>

            <div id="playing-section" class="hidden">
                <div class="participant-status assigned">
                    <h3>¬°Tu cartilla est√° lista!</h3>
                    <p>Marca los t√©rminos cuando el moderador los anuncie</p>
                </div>
                
                <div class="player-card-container">
                    <div id="playerCard" class="bingo-card"></div>
                    
                    <!-- Mobile Helper -->
                    <div style="text-align: center; margin-top: 15px; padding: 10px; background: #e8f4fd; border-radius: 8px; font-size: 14px; color: #2c3e50;">
                        <strong>üí° Tip:</strong> Toca las casillas para marcarlas. Rota tu dispositivo si necesitas m√°s espacio.
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="bingo-btn" onclick="claimBingo()">üéâ ¬°BINGO!</button>
                </div>
            </div>
        </div>
    </div>

    <script src="assets/js/app.js"></script>
</body>
</html>