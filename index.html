<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo Marketero</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iYmciIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojNjY3ZWVhO3N0b3Atb3BhY2l0eToxIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM3NjRiYTI7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJjYXJkIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj4KICAgICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3R5bGU9InN0b3AtY29sb3I6I2ZmZmZmZjtzdG9wLW9wYWNpdHk6MSIgLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIxMDAlIiBzdHlsZT0ic3RvcC1jb2xvcjojZjhmOWZhO3N0b3Atb3BhY2l0eToxIiAvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICA8L2RlZnM+CiAgCiAgPCEtLSBCYWNrZ3JvdW5kIC0tPgogIDxyZWN0IHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgcng9IjYiIGZpbGw9InVybCgjYmcpIi8+CiAgCiAgPCEtLSBCaW5nbyBDYXJkIC0tPgogIDxyZWN0IHg9IjYiIHk9IjgiIHdpZHRoPSIyMCIgaGVpZ2h0PSIxNiIgcng9IjIiIGZpbGw9InVybCgjY2FyZCkiIHN0cm9rZT0iI2Y4ZjlmYSIgc3Ryb2tlLXdpZHRoPSIwLjUiLz4KICA8L3N2Zz4K">
    
    <!-- Meta Tags Sociales -->
    <meta name="description" content="Bingo Web3 interactivo para comunidades de marketing y blockchain. Juega con tÃ©rminos de DeFi, NFT, DAO y mÃ¡s.">
    <meta name="keywords" content="bingo, web3, nft, defi, dao, blockchain, marketing, comunidad, juego">
    <meta name="author" content="MKT Community">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tu-dominio.com/">
    <meta property="og:title" content="Bingo Web3 - MKT Community">
    <meta property="og:description" content="Bingo Web3 interactivo para comunidades de marketing y blockchain. Juega con tÃ©rminos de DeFi, NFT, DAO y mÃ¡s.">
    <meta property="og:image" content="https://tu-dominio.com/favicon.svg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://tu-dominio.com/">
    <meta property="twitter:title" content="Bingo Web3 - MKT Community">
    <meta property="twitter:description" content="Bingo Web3 interactivo para comunidades de marketing y blockchain. Juega con tÃ©rminos de DeFi, NFT, DAO y mÃ¡s.">
    <meta property="twitter:image" content="https://tu-dominio.com/favicon.svg">
    
    <link rel="stylesheet" href="assets/css/styles.css">
    
    <!-- Firebase SDK v9+ (Modular) -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signInAnonymously, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js';
        import { getFirestore, collection, addDoc, doc, onSnapshot, updateDoc, setDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js';
        
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCgWVgfDgYOLCXvMoI6B8cKtc1lt0E2jOc",
            authDomain: "bingo-d2f28.firebaseapp.com",
            projectId: "bingo-d2f28",
            storageBucket: "bingo-d2f28.firebasestorage.app",
            messagingSenderId: "786733165579",
            appId: "1:786733165579:web:a5339c73eaf1d31c3eeb0e",
            measurementId: "G-17C462BPND"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // Make Firebase available globally
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseCreateUserWithEmailAndPassword = createUserWithEmailAndPassword;
        window.firebaseSignInWithEmailAndPassword = signInWithEmailAndPassword;
        window.firebaseSignOut = signOut;
        window.firebaseSignInAnonymously = signInAnonymously;
        window.firebaseOnAuthStateChanged = onAuthStateChanged;
        window.firebaseCollection = collection;
        window.firebaseAddDoc = addDoc;
        window.firebaseDoc = doc;
        window.firebaseOnSnapshot = onSnapshot;
        window.firebaseUpdateDoc = updateDoc;
        window.firebaseSetDoc = setDoc;
        window.firebaseServerTimestamp = serverTimestamp;
        
        console.log('Firebase v9+ initialized successfully');
    </script>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="community-name">MKT COMMUNITY</div>
            <h1>BINGO WEB3</h1>
            <p>Marketing & Blockchain Edition</p>
            <div id="moderator-cta" style="text-align:center; margin: 10px 0 20px;">
                <button class="control-btn" onclick="(function(){
                    const modeSelector = document.querySelector('.mode-selector');
                    if (modeSelector) modeSelector.classList.add('hidden');
                    document.getElementById('moderator-section').classList.remove('hidden');
                    document.getElementById('participant-mode').classList.add('hidden');
                    document.getElementById('moderator-mode').classList.remove('hidden');
                })()">Acceder como Moderador</button>
            </div>
            <div id="room-status" class="room-status hidden">
                <span id="room-status-text"></span>
            </div>
        </div>

        <div class="mode-selector hidden">
            <button class="mode-btn active" onclick="switchMode(event, 'participant')">ğŸ® Participante</button>
            <button class="mode-btn" onclick="switchMode(event, 'moderator')">ğŸ¯ Moderador</button>
        </div>

        <!-- Moderator Section -->
        <div id="moderator-section" class="moderator-section hidden">
            <h3>ğŸ¯ Panel de Moderador</h3>
            
            <!-- Login Section -->
            <div id="moderator-login" class="moderator-login">
                <h4>ğŸ” Iniciar SesiÃ³n como Moderador</h4>
                <p>Necesitas iniciar sesiÃ³n para crear y gestionar salas</p>
                
                <div class="login-form">
                    <div class="form-group">
                        <label for="moderatorEmail">ğŸ“§ Email:</label>
                        <input type="email" id="moderatorEmail" placeholder="tu@email.com" required>
                    </div>
                    <div class="form-group">
                        <label for="moderatorPassword">ğŸ”’ ContraseÃ±a:</label>
                        <input type="password" id="moderatorPassword" placeholder="MÃ­nimo 6 caracteres" required>
                    </div>
                    <div class="login-buttons">
                        <button class="control-btn" onclick="loginWithEmail()">ğŸšª Iniciar SesiÃ³n</button>
                        <button class="control-btn secondary" onclick="registerWithEmail()">ğŸ“ Registrarse</button>
                    </div>
                </div>
                
                <div id="loginStatus" class="login-status hidden">
                    <p>âœ… SesiÃ³n iniciada</p>
                </div>
            </div>
            
            <!-- Dashboard Section -->
            <div id="moderator-dashboard" class="moderator-dashboard hidden">
                <div class="moderator-info">
                    <h4>ğŸ‘‹ Hola, <span id="moderatorName">Moderador</span></h4>
                    <button class="control-btn secondary" onclick="logoutModerator()">ğŸšª Cerrar SesiÃ³n</button>
                </div>
                
                <div class="moderator-controls">
                    <button id="createRoomBtn" class="control-btn" onclick="createRoomWithFirebase()">ğŸ® Crear Nueva Sala</button>
                    <button id="shareBtn" class="control-btn hidden" onclick="shareGame()">ğŸ“¤ Compartir Enlace</button>
                </div>
                
                <div id="roomInfo" class="room-info hidden">
                    <div class="room-code">
                        <label>CÃ³digo de Sala:</label>
                        <div class="code-display">
                            <span id="roomCode">----</span>
                            <button onclick="copyRoomCode()" class="copy-btn">ğŸ“‹</button>
                        </div>
                    </div>
                    <div class="share-link">
                        <label>Enlace de Compartir:</label>
                        <div class="link-display">
                            <input type="text" id="shareLink" readonly>
                            <button onclick="copyShareLink()" class="copy-btn">ğŸ“‹</button>
                        </div>
                    </div>
                    <div class="share-instructions">
                        <p>ğŸ’¡ <strong>Instrucciones:</strong></p>
                        <p>1. Copia el enlace de arriba</p>
                        <p>2. CompÃ¡rtelo por WhatsApp, Telegram, etc.</p>
                        <p>3. Los participantes se unirÃ¡n automÃ¡ticamente</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Participant Mode -->
        <div id="participant-mode" class="content hidden">
            <div id="registration-section">
                <div class="registration-form">
                    <h2>Â¡Ãšnete al Bingo Web3!</h2>
                    <p style="color: #7f8c8d; margin-bottom: 20px;">Ingresa tu nombre para participar</p>
                    
                    <div class="form-group">
                        <label for="participantName">Tu nombre:</label>
                        <input type="text" id="participantName" placeholder="Ejemplo: Juan PÃ©rez" maxlength="20">
                    </div>
                    
                    <button class="register-btn" onclick="registerParticipant()">ğŸš€ Registrarse</button>
                </div>
            </div>

            <div id="waiting-section" class="hidden">
                <div class="participant-status waiting">
                    <h3>Â¡Registrado exitosamente!</h3>
                    <p>Esperando que el moderador asigne las cartillas...</p>
                    <div style="margin-top: 10px;">
                        <strong>Tu nombre:</strong> <span id="registeredName"></span>
                    </div>
                </div>
            </div>

            <div id="playing-section" class="hidden">
                <div class="participant-status assigned">
                    <h3>Â¡Tu cartilla estÃ¡ lista!</h3>
                    <p>Marca los tÃ©rminos cuando el moderador los anuncie</p>
                </div>
                
                <div class="player-card-container">
                    <div id="playerCard" class="bingo-card"></div>
                    
                    <!-- Mobile Helper -->
                    <div style="text-align: center; margin-top: 15px; padding: 10px; background: #e8f4fd; border-radius: 8px; font-size: 14px; color: #2c3e50;">
                        <strong>ğŸ’¡ Tip:</strong> Toca las casillas para marcarlas. Rota tu dispositivo si necesitas mÃ¡s espacio.
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="bingo-btn" onclick="claimBingo()">ğŸ‰ Â¡BINGO!</button>
                </div>
            </div>
        </div>

        <!-- Moderator Mode -->
        <div id="moderator-mode" class="content hidden">
            <div class="participants-list">
                <h3>Participantes Registrados</h3>
                <div id="participantsList"></div>
                <div style="text-align: center; margin-top: 15px; color: #7f8c8d;">
                    <span id="participantCount">0</span> participantes registrados
                </div>
            </div>

            <div class="moderator-controls">
                <button class="control-btn success" onclick="assignCards()">ğŸ“‹ Asignar Cartillas</button>
                <button class="control-btn" onclick="startGame()">â–¶ï¸ Iniciar Juego</button>
                <button class="control-btn" onclick="callNextTerm()">ğŸ¯ Siguiente TÃ©rmino</button>
                <button class="control-btn danger" onclick="resetGame()">ğŸ”„ Reiniciar</button>
            </div>

            <div class="game-controls">
                <div class="current-term" id="currentTerm">
                    Registra participantes y asigna cartillas para comenzar
                </div>

                <div class="stats">
                    <div class="stat">
                        <div class="stat-number" id="termsCalledCount">0</div>
                        <div>TÃ©rminos Aleatorios</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number" id="termsRemainingCount">90</div>
                        <div>TÃ©rminos Restantes</div>
                    </div>
                </div>

                <div>
                    <h4>TÃ©rminos Mostrados:</h4>
                    <div id="calledTermsList" class="called-terms"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="assets/js/app.js"></script>
</body>
</html>