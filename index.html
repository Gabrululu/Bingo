<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bingo Marketero</title>

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="favicon.svg" />

  <!-- Meta sociales -->
  <meta name="description" content="Bingo Web3 interactivo para comunidades de marketing y blockchain." />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Bingo Web3 - MKT Community" />
  <meta property="og:description" content="Juega con términos de DeFi, NFT, DAO y más." />
  <meta property="og:image" content="favicon.svg" />
  <meta name="theme-color" content="#0f172a" />

  <!-- Estilos base: centrado, tipografía y layout responsive -->
  <style>
    :root{
      /* Fondo */
      --bg-0:#0b0f2a; --bg-1:#101634; --bg-2:#141b3d;
      /* Texto */
      --txt-1:#eaf2ff; --txt-2:#b9c5e2; --txt-3:#8ea0c7;
      /* Marca */
      --magenta:#ff51b2; --orange:#ffb33a; --cyan:#38e0d2; --violet:#9353ff;
      /* Gradientes */
      --grad-brand: linear-gradient(135deg, var(--magenta), var(--orange), var(--cyan));
      --grad-card: linear-gradient(180deg, rgba(255,81,178,.10), rgba(56,224,210,.06));
      /* Acentos */
      --ok:#5be49b; --warn:#ffd166; --danger:#ff6b6b;
      /* Bordes/blur */
      --br:14px; --border:1px solid rgba(255,255,255,.10);
      --glass: backdrop-filter: blur(8px);
      --ring: 0 0 0 3px rgba(56,224,210,.25);
      --shadow: 0 8px 28px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 800px at 50% -20%, var(--bg-1), transparent 60%), var(--bg-0);
      color:var(--txt-1);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Contenedor principal centrado */
    .container{
      min-height:100dvh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    /* Tarjeta central */
    .card{width:min(980px, 100%);background:var(--bg-2);border:var(--border);border-radius:var(--br);box-shadow:var(--shadow);padding:clamp(20px, 2.5vw, 28px)}

    /* Header principal */
    .header{
      text-align:center;
      margin-bottom:22px;
    }
    .community-name{font-size:.85rem;letter-spacing:.25rem;color:var(--txt-3);text-transform:uppercase;margin-bottom:8px}
    h1{
      margin:0 0 6px;
      font-size:clamp(26px, 4.6vw, 40px);
      line-height:1.1;
    }
    .subtitle{margin:0;color:var(--txt-2);font-size:clamp(14px, 2.6vw, 16px)}

    /* Layout de secciones (stack) */
    .stack{display:flex; flex-direction:column; gap:18px}

    /* Botones */
    .btn{appearance:none;border:0;cursor:pointer;padding:.8rem 1.1rem;border-radius:12px;font-weight:700;transition:.15s ease;box-shadow:var(--shadow)}
    .btn:hover{transform:translateY(-1px)}
    .btn:active{transform:translateY(0)}
    .btn:focus-visible{outline:none;box-shadow:var(--shadow), var(--ring)}
    .btn-primary{background:var(--grad-brand);color:#0b0f2a}
    .btn-primary:hover{filter:saturate(1.05)}
    .btn-danger{background:var(--danger);color:#0b0f2a}
    .btn-secondary{background:transparent;border:var(--border);color:var(--txt-1)}
    .btn-secondary:hover{background:rgba(255,255,255,.06)}
    .btn-small{padding:8px 12px; font-size:.9rem}

    /* Formularios */
    .form{
      display:grid; gap:14px;
      background:rgba(2,6,23,.45);
      border:1px solid rgba(148,163,184,.15);
      border-radius:12px; padding:16px;
    }
    .form-row{display:grid; gap:6px}
    label{font-size:.95rem; color:var(--muted)}
    input[type="email"],
    input[type="password"],
    input[type="text"]{
      width:100%; padding:12px 14px; border-radius:10px;
      border:1px solid rgba(148,163,184,.25);
      background:#0b1220; color:var(--text);
    }
    input::placeholder{color:#64748b}
    .form-actions{display:flex; gap:10px; flex-wrap:wrap}

    /* Secciones del moderador */
    .dashboard-header{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      flex-wrap:wrap; margin-bottom:12px;
    }
    .user-info{display:flex; align-items:center; gap:10px; color:var(--txt-3)}
    .rooms-actions{display:flex; gap:10px; flex-wrap:wrap; margin-bottom:8px}
    .rooms-list, .participants-list, .called-terms-list{background:var(--bg-2);border:var(--border);border-radius:var(--br);padding:12px;min-height:48px}
    .no-rooms, .no-participants{color:var(--muted); margin:6px 0}

    .room-info{display:flex; align-items:center; gap:10px; flex-wrap:wrap}
    .status-badge{
      display:inline-block; padding:6px 10px; border-radius:999px;
      background:#0b1220; border:1px solid rgba(148,163,184,.25); color:#cbd5e1; font-size:.85rem;
    }

    .share-section{display:grid; gap:10px}
    .share-link-container{
      display:flex; gap:10px; flex-wrap:wrap;
    }
    #shareLink{flex:1 1 260px; min-width:240px; background:var(--bg-0); color:var(--txt-1); border:var(--border); border-radius:10px; padding:12px 14px}
    .game-controls .control-buttons{display:flex; gap:10px; flex-wrap:wrap}

    .current-term{
      padding:12px; border-radius:12px; background:#0b1220;
      border:1px solid rgba(148,163,184,.25);
    }

    /* Participante */
    .registration-form{
      display:grid; gap:12px;
      background:rgba(2,6,23,.45);
      border:1px solid rgba(148,163,184,.15);
      border-radius:12px; padding:16px;
      max-width:520px; margin-inline:auto;
      text-align:center;
    }
    .participant-status{ 
      background:rgba(2,6,23,.45); border:1px solid rgba(148,163,184,.15);
      border-radius:12px; padding:16px; text-align:center; max-width:720px; margin:12px auto;
    }
    .participant-status.waiting{ border-color:rgba(96,165,250,.35) }
    .participant-status.assigned{ border-color:rgba(16,185,129,.35) }

    .player-card-container{max-width:780px; margin:14px auto}
    .bingo-card{display:grid; grid-template-columns:repeat(5,1fr); gap:6px}
    .bingo-card div{
      background:#0b1220; border:1px solid rgba(148,163,184,.25);
      border-radius:10px; padding:10px; text-align:center; min-height:52px;
      display:flex; align-items:center; justify-content:center; word-break:break-word;
    }

    /* Utilidades */
    .hidden{display:none !important}
    .section{background:rgba(255,255,255,.01); border-radius:12px; padding:12px}
    .divider{height:1px; background:rgba(148,163,184,.15); margin:10px 0}

    /* Responsive tweaks */
    @media (max-width: 560px){
      .form-actions{flex-direction:column}
      .dashboard-header{flex-direction:column; align-items:flex-start}
    }
    /* Bingo Card UI polish */
    .card-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;width:100%;max-width:520px;margin:0 auto}
    .card-cell{aspect-ratio:1/1;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.04);display:flex;align-items:center;justify-content:center;padding:6px;transition:transform .08s ease, box-shadow .08s ease, background .08s ease;cursor:pointer;outline:none}
    .card-cell:hover,.card-cell:focus-visible{transform:translateY(-1px);box-shadow:0 4px 10px rgba(0,0,0,.25);border-color:rgba(255,255,255,.24)}
    .card-cell.marked{background:rgba(16,185,129,.25);border-color:rgba(16,185,129,.6)}
    .cell-text{font-size:clamp(10px,1.8vw,14px);line-height:1.15;text-align:center;color:#e8eef6;width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0 4px}
    @media (max-width:480px){.card-grid{gap:6px}.cell-text{font-size:12px}}
    /* Hero adjustments */
    .hero{position:relative;display:grid;place-items:center;min-height:60vh;padding-top:64px}
    .hero__inner{position:relative;text-align:center;max-width:720px;width:100%;padding:24px 16px 0;margin:0 auto}
    .hero__logo-badge{position:absolute;top:-36px;left:50%;transform:translateX(-50%);width:72px;height:72px;border-radius:50%;background:radial-gradient(closest-side, rgba(255,255,255,.18), rgba(255,255,255,.06));box-shadow:0 10px 25px rgba(0,0,0,.25);display:grid;place-items:center;z-index:2}
    .hero__branding{letter-spacing:.22em;font-weight:700;color:#41e3ff;margin-top:28px;margin-bottom:6px}
    .hero__title{font-size:clamp(32px,5.5vw,56px);line-height:1.05;margin:4px 0 6px;color:#f5ad7a}
    .hero__subtitle{color:#a9b4c5;margin:4px 0 18px;font-size:clamp(14px,2.2vw,18px)}
    .hero__cta{margin-top:12px}
    @media (max-width:480px){
      .hero{min-height:56vh;padding-top:56px}
      .hero__logo-badge{top:-28px;width:64px;height:64px}
      .hero__branding{margin-top:22px}
    }
    /* ====== CENTRADO GENERAL PARTICIPANTE ====== */
    .player-banner,.player-area,.player-cta{display:grid;place-items:center}
    .player-banner{margin:16px 0 8px}
    .banner-card{max-width:840px;width:100%;border-radius:12px;padding:16px 18px;text-align:center;border:1px solid rgba(255,255,255,.10);background:rgba(56,224,210,.10);color:#dff7f4}
    .banner-card.success h3{margin:0 0 6px;color:var(--ok)}
    .player-area{max-width:840px;width:100%;padding:8px 12px 0;margin:0 auto}
    .player-card{width:100%;display:grid;place-items:center;padding:8px 0}
    /* ====== GRID 5×5 ====== */
    .card-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:10px;width:min(520px,90vw)}
    .card-cell{aspect-ratio:1/1;border:1px solid rgba(255,255,255,.12);border-radius:12px;background:rgba(255,255,255,.04);color:var(--txt-1);display:flex;align-items:center;justify-content:center;padding:6px;cursor:pointer;transition:.1s ease;outline:none}
    .card-cell:hover,.card-cell:focus-visible{transform:translateY(-1px);box-shadow:0 8px 22px rgba(0,0,0,.35);border-color:rgba(255,255,255,.25)}
    .card-cell:disabled{cursor:default}
    .card-cell.marked{background:rgba(91,228,155,.28);border-color:rgba(91,228,155,.75)}
    .cell-free{background:linear-gradient(180deg,rgba(56,224,210,.16),rgba(255,255,255,.04));border-color:rgba(56,224,210,.55)}
    .cell-text{font-size:clamp(11px,1.8vw,14px);line-height:1.15;padding:0 4px;text-align:center;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}
    /* Tip y CTA centrados */
    .player-tip{margin:10px 0 14px;width:min(520px,90vw);border-radius:10px;padding:10px 12px;background:rgba(16,22,52,.75);border:1px solid rgba(255,255,255,.08);color:var(--txt-2);text-align:center;font-size:14px}
    .player-cta .bingo-btn{min-width:160px;padding:10px 14px;border-radius:12px;border:0;background:var(--grad-brand);color:#0b0f2a;font-weight:800;letter-spacing:.3px;box-shadow:0 8px 22px rgba(0,0,0,.35);transition:transform .1s ease, filter .12s ease}
    .player-cta .bingo-btn:hover{transform:translateY(-1px);filter:saturate(1.05)}
    @media(max-width:480px){.card-grid{gap:8px;width:92vw}.player-tip{width:92vw;font-size:13px}}
    /* ====== THEME GLOBAL ====== */
    .section,.dashboard-container,.rooms-section,.room-section{background:var(--bg-1);border:var(--border);border-radius:var(--br);box-shadow:var(--shadow)}
    .card,.participants-section,.share-section,.game-controls,.current-term-section,.called-terms-section{background:var(--bg-2);border:var(--border);border-radius:var(--br)}
    input[type="text"],input[type="email"],input[type="password"]{background:rgba(255,255,255,.04);color:var(--txt-1);border:1px solid rgba(255,255,255,.14);border-radius:10px}
    input:focus-visible{outline:none;box-shadow:var(--ring)}
    .status-badge{background:rgba(255,255,255,.06);color:var(--txt-2);border:1px solid rgba(255,255,255,.14);border-radius:999px;padding:6px 10px;font-weight:700;font-size:12px}
    .status-badge.lobby{background:rgba(255,179,58,.14);color:#ffd79a}
    .status-badge.live{background:rgba(56,224,210,.14);color:#9df4ec}
    .status-badge.ended{background:rgba(255,107,107,.16);color:#ffb4b4}

    /* ====== CONTROLS BAR ====== */
    .controls-bar{display:flex;flex-wrap:wrap;gap:14px;justify-content:center;align-items:center;padding:18px;background:var(--bg-2);border:var(--border);border-radius:var(--br);box-shadow:var(--shadow)}
    .ctl-btn{appearance:none;border:0;border-radius:12px;padding:.85rem 1.1rem;font-weight:800;letter-spacing:.2px;min-width:172px;text-align:center;color:#0b0f2a;box-shadow:var(--shadow);transition:transform .12s ease, filter .12s ease, opacity .12s ease}
    .ctl-btn:hover{transform:translateY(-1px);filter:saturate(1.05)}
    .ctl-btn:focus-visible{outline:none;box-shadow:var(--shadow),var(--ring)}
    .ctl-btn--primary{background:var(--grad-brand)}
    .ctl-btn--ghost{background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(255,255,255,.05));color:var(--txt-1);border:1px solid rgba(255,255,255,.14)}
    .ctl-btn--warn{background:linear-gradient(135deg,#ffd166,#ffb33a);color:#301b00}
    .ctl-btn--danger{background:#ff6b6b;color:#2a0c0c}
    .ctl-btn[disabled]{opacity:.45;filter:grayscale(.25);cursor:not-allowed;transform:none!important;box-shadow:none}
    @media(max-width:720px){.controls-bar{gap:10px}.ctl-btn{min-width:100%}}

    /* PARTICIPANTES ITEM */
    .participants-section .participant-item{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.10);border-radius:12px;padding:14px;display:flex;justify-content:space-between;align-items:center}
    .participant-name{font-weight:800;color:var(--txt-1)}
    .participant-status{text-transform:lowercase}

    /* TITULARES DE SECCIÓN */
    .section-title{font-weight:800;color:var(--txt-1);margin:8px 0 14px;position:relative}
    .section-title::after{content:"";display:block;height:2px;width:110px;margin-top:8px;background:linear-gradient(90deg,var(--magenta),transparent);opacity:.8}

    /* SHARE LINK */
    .share-link-container{display:flex;gap:10px;align-items:center}
    #shareLink{flex:1;background:rgba(255,255,255,.06);color:var(--txt-1);border:1px solid rgba(255,255,255,.14);border-radius:10px;padding:.75rem .9rem}
    #copyLinkBtn{padding:.75rem 1rem;border-radius:10px;background:var(--bg-2);border:1px solid rgba(255,255,255,.16);color:var(--txt-1);font-weight:700}
    #copyLinkBtn:hover{background:rgba(255,255,255,.08)}
    /* PARTICIPANT LAYOUT CENTERING */
    #participant-mode{display:grid;gap:16px;justify-items:center}
    #registration-section .registration-form{max-width:520px;width:100%;margin:0 auto}
    .player-banner{width:100%;display:grid;place-items:center}
    .player-banner .banner-card{max-width:840px;width:calc(100% - 32px);border-radius:12px;padding:12px 16px;text-align:center}
    .player-area{width:100%;display:grid;justify-items:center;gap:12px}
    .card-grid{margin:0 auto}
    #waiting-section .participant-status{display:grid;place-items:center;text-align:center;max-width:680px;width:calc(100% - 32px);margin:0 auto;border-radius:12px;padding:16px}
    .player-tip,.player-cta{width:min(520px,92vw);margin:0 auto;display:grid;place-items:center}
    .player-cta .bingo-btn{width:100%;max-width:220px}
  </style>

  <!-- Tu CSS (si lo usas) -->
  <link rel="stylesheet" href="assets/css/styles.css" />
</head>
<body>
  <div class="container">
    <main class="card stack" aria-live="polite">
      <!-- L A N D I N G -->
      <section id="landing-page" class="hero" aria-label="Inicio">
        <div class="hero__inner">
          <div class="hero__logo-badge" aria-hidden="true">
            <span style="font-size:28px;">🚀</span>
          </div>

          <div class="hero__branding">MKT COMMUNITY</div>
          <h1 class="hero__title">BINGO WEB3</h1>
          <p class="hero__subtitle">Marketing &amp; Blockchain Edition</p>

          <div id="moderator-cta" class="hero__cta">
            <button class="btn btn-primary" onclick="openModeratorLogin()">Acceder como Moderador</button>
          </div>
        </div>
      </section>

      <!-- A C C E S O  M O D E R A D O R -->
      <section id="moderator-login" class="hidden" aria-label="Acceso de moderador">
        <div class="form" style="max-width:520px; margin-inline:auto">
          <h2 style="margin:0 0 6px">🔐 Acceso de Moderador</h2>
          <form id="loginForm" class="stack" novalidate>
            <div class="form-row">
              <label for="email">Email</label>
              <input type="email" id="email" autocomplete="username" required />
            </div>
            <div class="form-row">
              <label for="password">Contraseña</label>
              <input type="password" id="password" autocomplete="current-password" required />
            </div>
            <div class="form-actions">
              <button type="submit" class="btn btn-primary">Iniciar Sesión</button>
              <button type="button" id="showRegister" class="btn btn-secondary">Registrarse</button>
            </div>
          </form>
          <form id="registerForm" class="hidden stack" novalidate>
            <div class="form-row">
              <label for="regEmail">Email</label>
              <input type="email" id="regEmail" autocomplete="username" required />
            </div>
            <div class="form-row">
              <label for="regPassword">Contraseña</label>
              <input type="password" id="regPassword" autocomplete="new-password" required minlength="6" />
            </div>
            <div class="form-row">
              <label for="regConfirmPassword">Confirmar Contraseña</label>
              <input type="password" id="regConfirmPassword" autocomplete="new-password" required />
            </div>
            <div class="form-actions">
              <button type="submit" class="btn btn-primary">Registrarse</button>
              <button type="button" id="showLogin" class="btn btn-secondary">Ya tengo cuenta</button>
            </div>
          </form>
        </div>
      </section>

      <!-- D A S H B O A R D  M O D E R A D O R -->
      <section id="moderator-dashboard" class="hidden stack" aria-label="Panel de moderador">
        <div class="dashboard-header">
          <h2 style="margin:0">🎮 Panel de Moderador</h2>
          <div class="user-info">
            <span id="moderatorName"></span>
            <button id="logoutBtn" class="btn btn-small btn-secondary">Cerrar Sesión</button>
          </div>
        </div>

        <!-- Mis salas -->
        <section id="my-rooms-section" class="stack section" aria-label="Mis salas">
          <h3 style="margin:0">🏠 Mis Salas</h3>
          <div class="rooms-actions">
            <button id="createRoomBtn" class="btn btn-primary">🎯 Crear Nueva Sala</button>
            <button id="refreshRoomsBtn" class="btn btn-secondary">🔄 Actualizar Lista</button>
          </div>
          <div id="roomsList" class="rooms-list">
            <p class="no-rooms">No tienes salas creadas</p>
          </div>
        </section>

        <!-- Gestión de sala -->
        <section id="room-management" class="hidden stack section" aria-label="Gestión de sala">
          <div class="room-info">
            <h3 style="margin:0">Sala: <span id="currentRoomCode"></span></h3>
            <span id="roomStatus" class="status-badge">Lobby</span>
            <button id="backToRoomsBtn" class="btn btn-small btn-secondary">← Volver a Mis Salas</button>
          </div>

          <div id="share-section" class="section-card">
            <h4 class="section-title">📤 Compartir Sala</h4>
            <p class="section-sub">Comparte este enlace con los participantes. Ellos solo ingresan su nombre.</p>
            <div class="share-link-row">
              <input id="shareLink" type="text" readonly aria-label="Enlace para compartir" />
              <button id="copyLinkBtn" class="btn btn-secondary">Copiar</button>
            </div>
          </div>

          <div class="section-card participants-card">
            <h4 class="section-title">👥 Participantes (<span id="participantCount">0</span>)</h4>
            <div id="participantsList" class="participants-list">
              <p class="no-participants">No hay participantes registrados</p>
            </div>
          </div>

          <div class="section-card controls-wrapper">
            <div class="controls-wrap">
              <div class="controls-title">🎮 Controles del Juego</div>

              <div class="controls-row">
                <button id="assignCardsBtn" class="btn">Asignar Cartillas</button>
                <button id="startGameBtn" class="btn btn-primary">Iniciar Juego</button>
                <button id="nextTermBtn" class="btn">Siguiente Término</button>
                <button id="resetGameBtn" class="btn btn-warn">Reiniciar Todo</button>
              </div>

              <div class="controls-danger">
                <button id="deleteRoomBtn" class="btn btn-danger">Eliminar Sala</button>
              </div>
            </div>
          </div>

          <div class="section-card current-term-section">
            <h4 class="section-title">🎯 Término Actual</h4>
            <div id="currentTerm" class="current-term">Registra participantes y asigna cartillas para comenzar</div>
          </div>

          <div class="section-card called-terms-section">
            <h4 class="section-title">📋 Términos Mostrados</h4>
            <div class="game-stats">Llamados: <strong id="termsCalledCount">0</strong> &nbsp; Restantes: <strong id="termsRemainingCount">0</strong></div>
            <div id="calledTermsList" class="called-terms-list"></div>
          </div>
        </section>
      </section>

      <!-- M O D O  P A R T I C I P A N T E -->
      <section id="participant-mode" class="hidden stack" aria-label="Participante">
        <div id="registration-section">
          <div class="registration-form">
            <h2 style="margin:0 0 6px">¡Únete al Bingo Web3!</h2>
            <p class="subtitle" style="margin:0 0 12px">Ingresa tu nombre para participar</p>
            <div class="form-row">
              <label for="participantName">Tu nombre</label>
              <input type="text" id="participantName" placeholder="Ejemplo: Juan Pérez" maxlength="40" />
            </div>
            <button class="btn btn-primary" onclick="registerParticipant()">🚀 Registrarse</button>
          </div>
        </div>

        <div id="waiting-section" class="hidden">
          <div class="participant-status waiting">
            <h3 style="margin:0 0 6px">¡Registrado exitosamente!</h3>
            <p class="subtitle" style="margin:0 0 8px">Esperando que el moderador asigne las cartillas…</p>
            <div><strong>Tu nombre:</strong> <span id="registeredName"></span></div>
          </div>
        </div>

        <div id="playing-section" class="hidden">
          <!-- Banner centrado -->
          <div class="player-banner">
            <div class="banner-card success">
              <h3>¡Tu cartilla está lista!</h3>
              <p>Marca las casillas cuando el moderador anuncie los términos.</p>
            </div>
          </div>

          <!-- Área centrada de jugador -->
          <div class="player-card-wrapper">
            <div id="playerCard" class="bingo-card" role="grid" aria-label="Cartilla de Bingo"></div>
          </div>
          
          <div class="player-tip">
            <span>💡 Tip: Toca las casillas para marcarlas. Rota tu dispositivo si necesitas más espacio.</span>
          </div>

          <div class="player-cta">
            <button class="bingo-btn" onclick="claimBingo()">🎉 ¡BINGO!</button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Firebase SDK (modular) -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
    import {
      getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword,
      signInAnonymously, signOut, onAuthStateChanged,
      setPersistence, browserLocalPersistence
    } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js';
    import {
      getFirestore, collection, addDoc, doc, onSnapshot, updateDoc, setDoc,
      deleteDoc, serverTimestamp, getDocs, query, where, orderBy, getDoc
    } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "AIzaSyCgWVgfDgYOLCXvMoI6B8cKtc1lt0E2jOc",
      authDomain: "bingo-d2f28.firebaseapp.com",
      projectId: "bingo-d2f28",
      storageBucket: "bingo-d2f28.firebasestorage.app",
      messagingSenderId: "786733165579",
      appId: "1:786733165579:web:a5339c73eaf1d31c3eeb0e",
      measurementId: "G-17C462BPND"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Persistencia del auth (mantiene UID anónimo entre recargas)
    try { await setPersistence(auth, browserLocalPersistence); } catch (e) { console.warn('Auth persistence warning:', e?.message || e); }

    // Exponer para app.js
    window.firebaseAuth = auth;
    window.firebaseDb = db;
    window.firebaseCreateUserWithEmailAndPassword = createUserWithEmailAndPassword;
    window.firebaseSignInWithEmailAndPassword = signInWithEmailAndPassword;
    window.firebaseSignOut = signOut;
    window.firebaseSignInAnonymously = signInAnonymously;
    window.firebaseOnAuthStateChanged = onAuthStateChanged;
    // No exponemos setPersistence/browserLocalPersistence, se aplica arriba una vez
    window.firebaseCollection = collection;
    window.firebaseAddDoc = addDoc;
    window.firebaseDoc = doc;
    window.firebaseOnSnapshot = onSnapshot;
    window.firebaseUpdateDoc = updateDoc;
    window.firebaseSetDoc = setDoc;
    window.firebaseDeleteDoc = deleteDoc;
    window.firebaseServerTimestamp = serverTimestamp;
    window.firebaseGetDocs = getDocs;
    window.firebaseQuery = query;
    window.firebaseWhere = where;
    window.firebaseOrderBy = orderBy;
    window.firebaseGetDoc = getDoc;

    console.log('Firebase v9+ inicializado');
  </script>

  <!-- Tu lógica -->
  <script src="assets/js/app.js"></script>
</body>
</html>
